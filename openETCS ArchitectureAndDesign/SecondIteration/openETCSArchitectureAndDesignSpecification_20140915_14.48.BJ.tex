\documentclass{template/openetcs_article}
% Use the option "nocc" if the document is not licensed under Creative Commons
%\documentclass[nocc]{template/openetcs_article}
\usepackage{lipsum,url}
\usepackage{supertabular}
\usepackage{multirow}
\usepackage{color, colortbl}
\definecolor{gray}{rgb}{0.8,0.8,0.8}
\usepackage[modulo]{lineno}
\graphicspath{{./template/}{.}{./images/}}
\begin{document}
\frontmatter
\project{openETCS}

%Please do not change anything above this line
%============================

%user specified macros
%\input{sections/macros.tex}

% The document metadata is defined below

%assign a report number here
\reportnum{OETCS/WP3/D3.5~--~01.01}

%define your workpackage here
\wp{Work-Package 3: ``Modeling''}

%set a title here
\title{openETCS System Architecture and Design Specification}

%set a subtitle here
\subtitle{First Iteration: ETCS Kernel Functions}

%set the date of the report here
\date{September 2014}


%document approval
%define the name and affiliation of the people involved in the documents approbation here
\creatorname{Baseliyos Jacob}
\creatoraffil{DB Netz}

\techassessorname{[assessor name]}
\techassessoraffil{[affiliation]}

\qualityassessorname{Izaskun de la Torre}
\qualityassessoraffil{SQS}

\approvalname{Klaus-R\"udiger Hase}
\approvalaffil{DB Netz}


%define a list of authors and their affiliation here

\author{Baseliyos Jacob}

\affiliation{DB Netz AG}

\author{Bernd Hekele}

\affiliation{DB-Netz AG, Peter Mahlmann, Peyman Farhangi\\
  V\"olckerstrasse 5\\
  D-80959 M\"unchen Freimann, Germany}

\author{Uwe Steinke}

\affiliation{Siemens AG}

\author{Christian Stahl}

\affiliation{TWT-GmbH}


% define the coverart
\coverart[width=350pt]{openETCS_EUPL}

%define the type of report
\reporttype{Description of work}


\begin{abstract}
%define an abstract here
This document gives an introduction to the architecture of the first openETCS iteration, the openETCS kernel functions. It has to be read as an add-on to the models in SysML, Scade and to additional reading referenced from the document.
\end{abstract}

%=============================
\maketitle

%Modification history
%if you do not need a modification history table for your document simply comment out the eight lines below
%=============================


\section*{Modification History}
\tablefirsthead{
\hline 
\rowcolor{gray} 
Version & Section & Modification / Description & Author \\\hline}
\begin{supertabular}{| m{1.2cm} | m{1.2cm} | m{6.6cm} | m{4cm} |}
0.1 & Document & Initial document providing the structure & Bernd Hekele \\\hline
0.2 & Sect.~\ref{sss:provposrep} & initial contribution and some pretty printing & Christian Stahl \\\hline
0.3 &Sect. & overtaking the author lead for the architecture & Baseliyos Jacob \\\hline
\end{supertabular}


\tableofcontents
\listoffiguresandtables
\newpage
%=============================

%Uncomment the next line if you need line numbers for tracebility when the document is in review
%\linenumbers
%=============================


% The actual document starts below this line
%=============================


\section{Introduction}

\input{sections/introduction.tex}

\subsection{History}

\input{sections/objectives.tex}

\subsection{Glossary and Abbreviations}

\subsection{References}

\textbf{SRS-Subset 26}\\
\textbf{QA-Plan: D1.3.1}\\
\textbf{Process: D2.3}\\
\textbf{Methods: D2.4}\\
\textbf{API: D2.7}\\

\section{Functions ERTMS/ETCS}

\subsection{introduction}

The ERTMS / ETCS system was developed with a view to interoperability of trains on the 
different European rail networks. It is divided into "tracks" - and "board" finishes 
and shall establish a mutual message operation, by beacons or through a "radio" - 
The transmission system (in this case a mobile telephone network GSM-R) is performed. 
It defines several operating levels, and the system must also interfaces with the 
existing monitoring systems of the trains (using STM) have. 
The ERTMS / ETCS system provides the transport operator (the track) the choice of conditions 
concerning the use and operation. 
The train must therefore may go with different operating conditions on routes. 
Thus has the onboard equipment but must be implemented, 
to the interoperability of the train to ensure on the other networks. 
These functions must therefore correspond to one standard: the SRS (version x.x.x). 

application functions, which have two different species of origin: 
defined in the SRS: here one finds in particular the 
speed monitoring- and transfer functions; these functions 
must be implemented in full accordance with the SRS; they can in 
indeed be on any network on which the train is used; these functions 
are described below in Section x.x.x; 


Moreover, there are functions to adapt to the train: so, for example, the processing 
a "separation distance" in the airborne equipment trigger: 
This is dependent on the distribution of functions between the 
Control monitoring equipment (which the ERTMS / ETCS), and the other 
CCS Systems.

\section{The openETCS Architecture of the initial kernel functions}

\newpage

\begin{figure}[hbtp]
\section{SRS Architecture}
\centering
\includegraphics[scale=0.8] {images/HighLevelArchitecture.png}
\caption{SRS architecture}
\end{figure}

\begin{figure}[hbtp]
\section{Functional Breakdown}
\centering
\includegraphics [angle=90, scale=0.5] {images/HighLevelFunctionalbreakdown}
\caption{SRS Breakdown}
\end{figure}

\newpage
\subsection{Description of the SRS Functions}

 \subsection{F1 Exchange input}
 F1: Exchange input\\
 See Figure 2 - Block F 1
 
  \subsection{F2 Elaboration track messages}
 F2: Elaboration track messages\\
 	F21: Receive Eurobalise Messages SRS § 3.4, § 3.6, § 3.16, § 3.17, § 4.8\\
 	F22: Receive Euroradio Messages SRS § 3.4, § 3.6, § 3.16, § 4.8\\
 	F23: Manage Eurobalise Messages SRS § 3.4, § 3.6, § 3.16\\
 	F24: Manage Cnx and Dncx Euroradio SRS § 3.5, § 3.15.1, § 5.15\\
 	F35: Send Euroradio Messages § 3.4, § 3.16\\
 	See Figure 3 - Block 2
 	
 \subsection{F2 breakdown}	
 \begin{figure}[hbtp]
\section{F2 Functional Breakdown}
\centering
\includegraphics [angle=90, scale=0.4] {images/F2_Breakdown}
\caption{Elaboration track messages breakdown}
\end{figure}

\newpage
\subsection{F3 Train loction}

F3: Train location SRS § 3.6.4, § 3.6.5, 3.6.6\\
See Figure 2 - Block F 3\\

 \subsection{F 4 Train Supervising in ERTMS Modus}
F4: Train supervision in ERTMS Modus\\
F41: Manage Level ERTMS/ETCS SRS § 5.1, § 3.6.5\\
F42: Manage Modus ERTMS/ETCS § 4, § 3.6.5, § 3.15.4, § 5.5, § 5.6, § 5.7, § 5.9, § 5.11, § 5.13\\
F43: Train Speed supervision SRS § 3.7, § 3.8, § 3.10, § 3.11, § 3.12, § 3.13, § 5.7, § 5.8, § 5.9\\
F44: Train Movement supervision § 3.14\\
F45: Train position supervision § 3.6.5, 4.4.8, § 4.4.11\\
F46: Data storage (§ 4.3), § 3.18\\
F47: Dialog with the driver § 5.4, § 3.12.3\\
F48: Manage brake controll § 3.14.1\\ 
F49: Manage Train Controll, § 3.12.1\\
See Figure 4 - Block 4

 \subsection{F4 breakdown}	
 \begin{figure}[hbtp]
\section{F4 Functional Breakdown}
\centering
\includegraphics [angle=90, scale=0.35] {images/F4_Breakdown}
\caption{Train Supervising in ERTMS Modus}
\end{figure}

\newpage

 \subsection{F5 Exchange outpout}
 F5: Exchange output\\
 See Figure 2 - Block F 5\\
 
 \subsection{centralized data structure approach}
 \begin{figure}[hbtp]
\centering
\includegraphics [scale=0.6] {images/CentralizedDataStrukture_2}
\caption{Centralized data structure approach architecture}
\end{figure}


 \begin{figure}[hbtp]
\centering
\includegraphics [scale=0.7] {images/CentralizedDataStructure_1}
\caption{Centralized data structure approach breakdown}
\end{figure}

\newpage

\subsection{Alstom High Level Approach}
 \begin{figure}[hbtp]
\section{Alstom High Level SRS Architecture}
\centering
\includegraphics [scale=0.8] {images/Alstom_High_Level_Approach}
\caption{Alstom SRS Architecture Approach}
\end{figure}

\newpage
\subsection{The openETCS Tool-Chain and its impacts on the actual model}

For understanding the modelling process and the modeling guidelines, we refer to \url{https://github.com/openETCS/modeling/blob/master/DescriptionOfWork/NewModelingDescriptionOfWork.pdf}.

To summarize the design process, the following rules are in use:
\begin{itemize}
\item Papyrus / SysML is used for modelling the architecture. Functions are visible on this SysML level.
\item No behaviour model is allowed on SysML level.
\item For referencing the requirements, links from the SysML model to the requirements document (in ProR) are being used.
\item Details and especially behaviour is part of the Scade models.
\item All interfaces (see also data-dictionary below) are available on bit-level.
\item In the architecture model in SysML, all interfaces are available on a functional level for interfaces inside and outside the model and for interfaces between dedicated functions. Due to tool constrains the current model does not show all details for all interfaces (see dataDictionary).
\end{itemize}

The openETCS tool-chain for doing the modelling work consists of the following components:
\begin{itemize}
	\item [\textbf{Papyrus}]: for modelling the architecture (Kepler version).\\
	In this phase only the Kepler version of the tool can be used due to incompatibilities of the Kepler and the Luna version on the SysML model. The SysML models are stored in the following location: \url{https://github.com/openETCS/modeling/tree/master/model/sysml}.
	\item [\textbf{ProR}]: for keeping the requirements (REQIF).\\
	The subset 26 is converted into a REQIF-format and also stored in the modeling repository on Github. The openETCS toolchain supports the linking of SysML model parts to SRS-Requirements. These results are also part of the architecture.
	\item [\textbf{Scade}]: for designing and formalising the functions Scade version 15.2 is used.\\
	The models are stored in this location: \url{https://github.com/openETCS/modeling/tree/master/model/Scade}.
	With the component Scade System Scade also has a component for designing the architecture.
\end{itemize}

In principle, the synchronisation mechanism of Scade was planned to be used for synchronising the SysML architecture and the Scade models. The idea is to automatically synchronise the SysML types and blocks with the Scade type definitions and the Scade Operators. Unfortunately, with the current set of tools this idea cannot be realised. We will investigate other tools and models to find a solution. 

In addition, faults in the Kepler Papyrus version made it difficult for several members of the team to work on different submodels of the openETCS model. The issue will be solved when changing to the Luna version of Papyrus.



\section{Functions of the openETCS Model}

\subsection{openETCS Data Dictionary}

\input{sections/dataDictionary.tex}

\subsection{openETCS Generic API}

\input{sections/GenericAPI.tex}

\subsection{openETCS Balise Group}

\input{sections/baliseGroup.tex}

\subsubsection{Perform Balise Decoding}
\subsection{openETCS Train Position}

\input{sections/trainPosition.tex}


\nocite{*}

\bibliographystyle{unsrt}
\bibliography{erdc}



\begin{thebibliography}{9}

\bibitem{lamport94}
  Leslie Lamport,
  \emph{\LaTeX: A Document Preparation System}.
  Addison Wesley, Massachusetts,
  2nd Edition,
  1994.

\end{thebibliography}

%===================================================
%Do NOT change anything below this line

\end{document}
